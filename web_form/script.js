// configuration
num_agents = 6
max_time = 5
max_score = 100

// Add answers as a list here
// data = [{'episode': 0, 'leaderName': 5}, {'episode': 1, 'leaderName': 0}, {'episode': 2, 'leaderName': 0}, {'episode': 3, 'leaderName': 1}, {'episode': 4, 'leaderName': 4}]

// our algorithms
// data = [{'algo_stage': '4.3', 'episode': 0, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 1, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 2, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 3, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 4, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 5, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 6, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 7, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 8, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 9, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 10, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 11, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 12, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 13, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 14, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 15, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 16, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 17, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 18, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 19, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 20, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 21, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 22, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 23, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 24, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 25, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 26, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 27, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 28, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 29, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 30, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 31, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 32, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 33, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 34, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 35, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 36, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 37, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 38, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 39, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 40, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 41, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 42, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 43, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 44, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 45, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 46, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 47, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 48, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 49, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 50, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 51, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 52, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 53, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 54, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 55, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 56, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 57, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 58, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 59, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 60, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 61, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 62, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 63, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 64, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 65, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 66, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 67, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 68, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 69, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 70, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 71, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 72, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 73, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 74, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 75, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 76, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 77, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 78, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 79, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 80, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 81, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 82, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 83, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 84, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 85, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 86, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 87, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 88, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 89, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 90, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 91, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 92, 'leaderName': 0}, {'algo_stage': '4.3', 'episode': 93, 'leaderName': 5}, {'algo_stage': '4.3', 'episode': 94, 'leaderName': 4}, {'algo_stage': '4.3', 'episode': 95, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 96, 'leaderName': 3}, {'algo_stage': '4.3', 'episode': 97, 'leaderName': 2}, {'algo_stage': '4.3', 'episode': 98, 'leaderName': 1}, {'algo_stage': '4.3', 'episode': 99, 'leaderName': 2}]


// genetic and scripted
data = [{'algo_stage': 'None', 'leaderName': 4, 'episode': 0}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 1}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 2}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 3}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 4}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 5}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 6}, {'algo_stage': 'None', 'leaderName': 3, 'episode': 7}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 8}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 9}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 10}, {'algo_stage': 'None', 'leaderName': 3, 'episode': 11}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 12}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 13}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 14}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 15}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 16}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 17}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 18}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 19}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 20}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 21}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 22}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 23}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 24}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 25}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 26}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 27}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 28}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 29}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 30}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 31}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 32}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 33}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 34}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 35}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 36}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 37}, {'algo_stage': 'None', 'leaderName': 3, 'episode': 38}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 39}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 40}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 41}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 42}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 43}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 44}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 45}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 46}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 47}, {'algo_stage': 'None', 'leaderName': 3, 'episode': 48}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 49}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 50}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 51}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 52}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 53}, {'algo_stage': 'None', 'leaderName': 3, 'episode': 54}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 55}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 56}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 57}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 58}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 59}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 60}, {'algo_stage': 'None', 'leaderName': 3, 'episode': 61}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 62}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 63}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 64}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 65}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 66}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 67}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 68}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 69}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 70}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 71}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 72}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 73}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 74}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 75}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 76}, {'algo_stage': 'None', 'leaderName': 0, 'episode': 77}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 78}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 79}, {'algo_stage': 'None', 'leaderName': 3, 'episode': 80}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 81}, {'algo_stage': 'None', 'leaderName': 3, 'episode': 82}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 83}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 84}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 85}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 86}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 87}, {'algo_stage': 'None', 'leaderName': 3, 'episode': 88}, {'algo_stage': 'None', 'leaderName': 3, 'episode': 89}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 90}, {'algo_stage': 'None', 'leaderName': 3, 'episode': 91}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 92}, {'algo_stage': 'None', 'leaderName': 4, 'episode': 93}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 94}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 95}, {'algo_stage': 'None', 'leaderName': 2, 'episode': 96}, {'algo_stage': 'None', 'leaderName': 1, 'episode': 97}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 98}, {'algo_stage': 'None', 'leaderName': 5, 'episode': 99}]

num_demos = 3;
num_episodes = 50; 


// Initialize
qID = 0;
numQDone = 0;
lastChoice = "0"
lastConf = 50
t1 = max_time;
t2 = 0;
interval = null;
numCorrect = 0;
totScore = 0;

// Randomly generate choice
// algoStage = getRndInteger(2,4).toString();			// {2,3,4}
// if(algoStage == "4")
// {
// 	algoSubstage = getRndInteger(1,3);			// {4.1, 4.2. 4.3}
// 	algoStage = algoStage+"."+algoSubstage;	
// }

algoStage = getRndInteger(0,1)
if(algoStage==0)
{
	algoStage='genetic'
}
else
{
	algoStage='scripted_pd'
}




console.log("algoStage", algoStage)
// video_path_same_color = "videos/stage_"+algoStage+"_results_same_color/videos/"
// video_path_diff_color = "videos/stage_"+algoStage+"_results/videos/"

video_path_same_color = "videos/"+algoStage+"_results_same_color/videos/"
video_path_diff_color = "videos/"+algoStage+"_results/videos/"



// grab entities from html
startButton = document.getElementById("start-btn");
nextButton = document.getElementById("next-btn");
introText = document.getElementById("intro");
instructionsText = document.getElementById("instructions");
endText = document.getElementById("end");
couponText = document.getElementById("coupon");
questionContainer = document.getElementById("question-container");
answerButtons = document.getElementById("answer-buttons");
submitButton = document.getElementById("submit-btn")
resultContainer = document.getElementById("result");
sliderContainer = document.getElementById("slider-container")
timeCounter = document.getElementById("counter");
progressBar = document.getElementById("progress");
scoreCard = document.getElementById("scorecard")
startButton.addEventListener("click", start);
xhr = new XMLHttpRequest();


function randomStr(len, arr) { 
            var ans = ''; 
            for (var i = len; i > 0; i--) { 
                ans +=  
                  arr[Math.floor(Math.random() * arr.length)]; 
            } 
            return ans; 
        } 

function getRndInteger(min, max) {
  return Math.floor(Math.random() * (max - min + 1) ) + min;
}

// counter
function downCounter()
{
	if(t1>0)
	{
		t1--;
		timeCounter.innerText = "Current Max Possible " + t1*(max_score/max_time);
	}
}

function upCounter()
{
	t2++;
}


// add buttons
function add(id) {
    var element = document.createElement("input");
    element.setAttribute("type", "button");
    element.setAttribute("value", id);
    element.setAttribute("name", "button_"+id);
    element.setAttribute("onclick", "update_answer(id)");
    document.body.appendChild(element);
}

function start()
{
	console.log("Starting")
	startButton.removeEventListener("click", start);
	introText.classList.add("hide")
	instructionsText.classList.add("hide");
	startButton.classList.add("hide")
	questionContainer.classList.remove("hide")
	progressBar.classList.remove("hide");
	scoreCard.classList.remove("hide")
	timeCounter.classList.remove("hide")
	showNextQuestion()
}

function realStart()
{
	console.log("real start");
	questionContainer.classList.add("hide");
	progressBar.classList.add("hide");
	scoreCard.classList.add("hide");
	resultContainer.classList.add("hide");
	timeCounter.classList.add("hide");
	nextButton.classList.add("hide");

	numCorrect = 0;
	totScore = 0;
	numQDone = 0;
	scoreCard.innerText = "Score | Overall " + totScore + "/" + (numQDone)*max_score + " | "

	instructionsText.innerText = "The demo is over. You will be shown "+num_episodes+" episodes. Let's start!";
	instructionsText.classList.remove("hide");
	startButton.addEventListener("click", showNextQuestion);
	startButton.classList.remove("hide");
}

function subjectiveQuestion()
{
	console.log("asking the subjective question");
	answerButtons.classList.add("hide")

	
	reset();
	progressBar.classList.add("hide");
	timeCounter.classList.add("hide");
	questionContainer.getElementsByClassName("video")[0].classList.add("hide")
	questionContainer.getElementsByClassName("question")[0].innerText = "What differences did you observe between the leader and the other agents?"
	questionContainer.getElementsByClassName("textInput")[0].classList.remove("hide")
	submitButton.classList.remove("hide")
	submitButton.addEventListener("click", end)
}

function end()
{
	text = questionContainer.getElementsByClassName("textInput")[0].value;
	console.log(text);
	data.push({"observation": text});

	// generate coupon
	coupon = Math.random().toString(36).slice(2); 
	data.push({"coupon": coupon});
	couponText.innerText += coupon;

	data_processed = JSON.stringify(data);
	xhr.open("POST", "savedata.php", true);
	xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xhr.send("data="+data_processed);
		

	reset();
	questionContainer.getElementsByClassName("textInput")[0].value="";
	submitButton.classList.add("hide");
	answerButtons.classList.add("hide");
	questionContainer.classList.add("hide");
	progressBar.classList.add("hide");
	scoreCard.classList.add("hide");
	timeCounter.classList.add("hide");
	endText.classList.remove("hide");
	couponText.classList.remove("hide");
	console.log(data);
	console.log(data_processed);
}

function showNextQuestion()
{
	console.log("showing next question");
	reset();
	console.log('qid', qID)
	
	if(qID==num_demos+num_episodes)
		subjectiveQuestion();
	else
	{
		// update video
		progressBar.innerText = qID<num_demos?"Episode "+(qID+1)+"/"+num_demos+" | ":"Episode "+(qID+1-num_demos)+"/"+num_episodes+" | "
		vid = questionContainer.getElementsByClassName("video")[0]
		vid.src = video_path_same_color+qID+".webm";
		setTimeout(playQuestionVid, 500)
	}
}

function playQuestionVid()
{
	document.onkeypress = function (e) {
												if(e.key==" ")
												{
													console.log("spacebar");
													document.onkeypress = null;
													showAnswerButtons()
												}
										   };
	vid = questionContainer.getElementsByClassName("video")[0]
	vid.play()
	// vid.loop = false;
	interval = setInterval(downCounter, 1000);
}

function showAnswerButtons()
{
	console.log("showing answer buttons")
	clearInterval(interval);
	questionContainer.getElementsByClassName("video")[0].pause();
	question = questionContainer.getElementsByClassName("question")[0];
	question.innerText = "Who do you think is the leader?"
	for(i=0;i<num_agents;i++)
	{
		console.log("new buttons")
		button = document.createElement("button")
		button.innerText = i
		button.addEventListener("click", showConfidenceSlider)
		answerButtons.appendChild(button)
		answerButtons.classList.remove("hide")
	}
	t2 = 0;
	// timeCounter.innerText = "Time elapsed: " + t2;
	interval = setInterval(upCounter, 1000);
}

function showConfidenceSlider(e)
{
	console.log("showing confidence slider");
	nextButton.removeEventListener("click", showNextQuestion);
	clearInterval(interval)
	question = questionContainer.getElementsByClassName("question")[0];
	question.innerText = "How confident are you?"
	lastChoice = e.target.innerText;
	answerButtons.classList.add("hide");
	sliderContainer.classList.remove("hide")
	slider = sliderContainer.getElementsByClassName("slider")[0];
	text = sliderContainer.getElementsByClassName("text")[0];
	lastConf = 50;
	slider.value = lastConf;
	text.innerText = lastConf + "%";
	slider.addEventListener('change', function(){lastConf = slider.value; text.innerText = slider.value + "%";});
	submitButton.classList.remove("hide");
	submitButton.addEventListener("click", update_answer);
}


// at the begining of each question
function reset()
{
	nextButton.removeEventListener("click", realStart);
	while(answerButtons.firstChild)
		answerButtons.removeChild(answerButtons.firstChild)
	questionContainer.classList.remove("hide");
	progressBar.classList.remove("hide");
	scoreCard.classList.remove("hide");
	timeCounter.classList.remove("hide");
	startButton.classList.add("hide");
	instructions.classList.add("hide");
	question = questionContainer.getElementsByClassName("question")[0];
	question.innerText = "Who do you think is the leader? Press spacebar when you've identified the leader."

	resultContainer.classList.forEach(element => resultContainer.classList.remove(element))
	resultContainer.innerText = "";

	nextButton.classList.add("hide");
	
	t1 = max_time;
	timeCounter.innerText = "Current Max Possible " + t1 *(max_score/max_time);
}




function update_answer()
{	
	console.log(lastChoice, lastConf)
	submitButton.removeEventListener("click", update_answer);
	submitButton.classList.add("hide");
	sliderContainer.classList.add("hide");
	question = questionContainer.getElementsByClassName("question")[0];
	question.innerText = ""
	
	trueID = data[qID].leaderName
	correct = lastChoice == trueID;
	numCorrect += correct;
	curScore = correct*t1*(max_score/max_time)
	totScore += curScore;
	numQDone += 1;
	console.log("numCorrect", numCorrect)
	scoreCard.innerText = "Score | Overall " + totScore + "/" + (numQDone)*max_score + " | "
	timeCounter.innerText = "Current " + curScore
	prefix = "True ID: "+trueID+". You chose: "+lastChoice+". "
	suffix = correct?"Correct choice :)":"Wrong choice :(";
	resultContainer.innerText = prefix+suffix 
	
	// for color
	resClass = correct?"correct":"wrong";
	resultContainer.classList.add(resClass)
	resultContainer.classList.remove("hide");
	console.log("resultContainer", resultContainer.classList)

	// storing
	data[qID].choice = parseInt(lastChoice);
	data[qID].confidence = parseInt(lastConf);
	data[qID].correct = correct;
	data[qID].score = curScore;		
	data[qID].time2answer = t1;
	data[qID].latency = t2; 		// time spacebar -> button click 
	data[qID].algo_stage = algoStage;

	qID++;
	if(qID==num_demos)	
	{
		console.log("demo end")
		nextButton.addEventListener("click", realStart);
	}
	else
	{
		console.log("simply next question")
		nextButton.addEventListener("click", showNextQuestion);
	}
	nextButton.classList.remove("hide")
	vid.src = video_path_diff_color+(qID-1)+".webm";		
	setTimeout(playReviewVideo, 1000);
}

function playReviewVideo()
{
	vid = questionContainer.getElementsByClassName("video")[0]
	vid.play()

}

